# üõ°Ô∏è –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## –û–ø–∏—Å–∞–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∫–ª–∞–¥–∫–∞ "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å" –≤ AI-–≥–∏–¥ —Å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –∏ SOS —Å–∏–≥–Ω–∞–ª–æ–≤.

## –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

### 1. –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
- 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥ (–±—É–∫–≤—ã –∏ —Ü–∏—Ñ—Ä—ã)
- –ú–æ–∂–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ–¥–Ω–∏–º –∫–ª–∏–∫–æ–º
- –ö–æ–¥ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∏ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
- –í–≤–µ–¥–∏—Ç–µ 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥ –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤—ã —Å–º–æ–∂–µ—Ç–µ –≤–∏–¥–µ—Ç—å –µ–≥–æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ (–µ—Å–ª–∏ –æ–Ω –≤–≤–µ–ª –≤–∞—à –∫–æ–¥)
- –ò–ª–∏ –æ–Ω —Å–º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å –≤–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ (–µ—Å–ª–∏ –≤—ã –≤–≤–µ–ª–∏ –µ–≥–æ –∫–æ–¥)

### 3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏
- –í–∏–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
- –ú–æ–∂–µ—Ç–µ —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–±–∞–≤–∏–ª–∏ –≤–∞—à –∫–æ–¥
- –í–∏–¥–∏—Ç–µ, –∫—Ç–æ –º–æ–∂–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ

### 4. SOS —Å–∏–≥–Ω–∞–ª
- –ö–Ω–æ–ø–∫–∞ SOS –¥–ª—è —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–∏–≥–Ω–∞–ª –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –∫–æ–Ω—Ç–∞–∫—Ç—É
- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–≤–æ–Ω–æ–∫ (—Ç—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã–º API)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

### –ö–æ–ª–ª–µ–∫—Ü–∏—è `users` (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ):
```json
{
  "_id": ObjectId("..."),
  "email": "...",
  "name": "...",
  "safetyCode": "ABC123"  // –ù–æ–≤–æ–µ –ø–æ–ª–µ - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–¥
}
```

### –ö–æ–ª–ª–µ–∫—Ü–∏—è `safetyContacts` (–Ω–æ–≤–∞—è):
```json
{
  "_id": ObjectId("..."),
  "userId": "id_–≤–ª–∞–¥–µ–ª—å—Ü–∞_–∫–æ–¥–∞",
  "contactUserId": "id_—Ç–æ–≥–æ_–∫—Ç–æ_–≤–≤–µ–ª_–∫–æ–¥",
  "createdAt": ISODate("..."),
  "lastLocation": {
    "lat": 43.2,
    "lng": 76.8,
    "timestamp": ISODate("...")
  }
}
```

### –ö–æ–ª–ª–µ–∫—Ü–∏—è `sosAlerts` (–Ω–æ–≤–∞—è):
```json
{
  "_id": ObjectId("..."),
  "contactId": "id_—Å–≤—è–∑–∏",
  "fromUserId": "id_–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è",
  "toUserId": "id_–ø–æ–ª—É—á–∞—Ç–µ–ª—è",
  "location": {
    "lat": 43.2,
    "lng": 76.8
  },
  "timestamp": ISODate("..."),
  "status": "pending",
  "message": "SOS –æ—Ç –ò–º—è"
}
```

## API Endpoints:

### GET `/api/safety/code`
–ü–æ–ª—É—á–∏—Ç—å –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### GET `/api/safety/contacts`
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### POST `/api/safety/contacts`
–î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç –ø–æ –∫–æ–¥—É
```json
{
  "code": "ABC123"
}
```

### DELETE `/api/safety/contacts?id=...`
–£–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç

### POST `/api/safety/location`
–û–±–Ω–æ–≤–∏—Ç—å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ
```json
{
  "lat": 43.2,
  "lng": 76.8
}
```

### POST `/api/safety/sos`
–û—Ç–ø—Ä–∞–≤–∏—Ç—å SOS —Å–∏–≥–Ω–∞–ª
```json
{
  "contactId": "...",
  "lat": 43.2,
  "lng": 76.8
}
```

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å A** –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ABC123`)
2. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å B** –≤–≤–æ–¥–∏—Ç –∫–æ–¥ `ABC123` –≤ –ø–æ–ª–µ "–î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç"
3. –°–æ–∑–¥–∞–µ—Ç—Å—è —Å–≤—è–∑—å:
   - `userId`: ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è A (–≤–ª–∞–¥–µ–ª–µ—Ü –∫–æ–¥–∞)
   - `contactUserId`: ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è B (—Ç–æ—Ç, –∫—Ç–æ –≤–≤–µ–ª –∫–æ–¥)
4. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å B** –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è A**
5. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å A** –≤–∏–¥–∏—Ç –≤ —Å–ø–∏—Å–∫–µ, —á—Ç–æ **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å B** –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –µ–≥–æ
6. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å A** –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è B** –∏–∑ —Å–ø–∏—Å–∫–∞

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º:

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–≤–æ–Ω–∫–∞ –ø—Ä–∏ SOS –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- Twilio API
- –î—Ä—É–≥–∏–µ SMS/–∑–≤–æ–Ω–æ–∫ —Å–µ—Ä–≤–∏—Å—ã
- –ò–ª–∏ –ø—Ä–æ—Å—Ç–æ `tel:` —Å—Å—ã–ª–∫—É (–µ—Å–ª–∏ –µ—Å—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ –ø—Ä–æ—Ñ–∏–ª–µ)

## –í–∞–ª–∏–¥–∞—Ü–∏—è MongoDB:

–ö–æ–ª–ª–µ–∫—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏. –ï—Å–ª–∏ –µ—Å—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ö–µ–º—ã, –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:

### `users` –∫–æ–ª–ª–µ–∫—Ü–∏—è:
```json
{
  "$jsonSchema": {
    "bsonType": "object",
    "required": ["email", "password", "name", "createdAt", "updatedAt"],
    "properties": {
      "email": { "bsonType": "string" },
      "password": { "bsonType": "string" },
      "name": { "bsonType": "string" },
      "createdAt": { "bsonType": "date" },
      "updatedAt": { "bsonType": "date" },
      "safetyCode": {
        "bsonType": "string",
        "pattern": "^[A-Z0-9]{6}$",
        "description": "–£–Ω–∏–∫–∞–ª—å–Ω—ã–π 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"
      }
    }
  }
}
```

### `safetyContacts` –∫–æ–ª–ª–µ–∫—Ü–∏—è:
```json
{
  "bsonType": "object",
  "required": ["userId", "contactUserId", "createdAt"],
  "properties": {
    "userId": { "bsonType": "string" },
    "contactUserId": { "bsonType": "string" },
    "createdAt": { "bsonType": "date" },
    "lastLocation": {
      "bsonType": "object",
      "properties": {
        "lat": { "bsonType": "double" },
        "lng": { "bsonType": "double" },
        "timestamp": { "bsonType": "date" }
      }
    }
  }
}
```

