# üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è MongoDB –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø–µ—Ä–µ–¥–∞—á–∏ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è

## –í–∞–∂–Ω–æ

**–í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ö–µ–º—ã –ù–ï —É—Å–∫–æ—Ä—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã** - –æ–Ω–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö. –î–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –Ω—É–∂–Ω—ã **–∏–Ω–¥–µ–∫—Å—ã**.

## –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

### 1. –ö–æ–ª–ª–µ–∫—Ü–∏—è `users`

–°–æ–∑–¥–∞–π—Ç–µ –∏–Ω–¥–µ–∫—Å –Ω–∞ `safetyCode` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –∫–æ–¥—É:

```javascript
use sayahat

// –ò–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –∫–æ–¥—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
db.users.createIndex({ safetyCode: 1 }, { unique: true, sparse: true })

// –ò–Ω–¥–µ–∫—Å –Ω–∞ email (–µ—Å–ª–∏ –µ—â–µ –Ω–µ—Ç)
db.users.createIndex({ email: 1 }, { unique: true })
```

### 2. –ö–æ–ª–ª–µ–∫—Ü–∏—è `safetyContacts` (–í–ê–ñ–ù–û!)

–≠—Ç–∏ –∏–Ω–¥–µ–∫—Å—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤:

```javascript
use sayahat

// –°–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ—Å–Ω–æ–≤–Ω–æ–π –∑–∞–ø—Ä–æ—Å)
db.safetyContacts.createIndex({ userId: 1, contactUserId: 1 })

// –ò–Ω–¥–µ–∫—Å –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ (–∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–µ–ª —á—É–∂–æ–π –∫–æ–¥)
db.safetyContacts.createIndex({ contactUserId: 1, userId: 1 })

// –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –æ–¥–∏–Ω —Å–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å –¥–ª—è –æ–±–æ–∏—Ö —Å–ª—É—á–∞–µ–≤
db.safetyContacts.createIndex({ 
  userId: 1, 
  contactUserId: 1 
}, { name: "user_contact_idx" })

// –ò–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è
db.safetyContacts.createIndex({ userId: 1 })
```

### 3. –ö–æ–ª–ª–µ–∫—Ü–∏—è `sosAlerts`

```javascript
use sayahat

// –ò–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö SOS —Å–∏–≥–Ω–∞–ª–æ–≤
db.sosAlerts.createIndex({ toUserId: 1, status: 1, timestamp: -1 })
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–¥–µ–∫—Å–æ–≤

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∫–∞–∫–∏–µ –∏–Ω–¥–µ–∫—Å—ã —É–∂–µ —Å–æ–∑–¥–∞–Ω—ã:

```javascript
// –î–ª—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏ users
db.users.getIndexes()

// –î–ª—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏ safetyContacts
db.safetyContacts.getIndexes()

// –î–ª—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏ sosAlerts
db.sosAlerts.getIndexes()
```

## –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

```javascript
// –£–¥–∞–ª–∏—Ç—å –∏–Ω–¥–µ–∫—Å
db.safetyContacts.dropIndex("index_name")
```

## –ü–æ–ª–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—Å–µ—Ö –∏–Ω–¥–µ–∫—Å–æ–≤

```javascript
use sayahat

// –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è users
db.users.createIndex({ safetyCode: 1 }, { unique: true, sparse: true })
db.users.createIndex({ email: 1 }, { unique: true })

// –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è safetyContacts (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã!)
db.safetyContacts.createIndex({ userId: 1, contactUserId: 1 })
db.safetyContacts.createIndex({ contactUserId: 1 })

// –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è sosAlerts
db.sosAlerts.createIndex({ toUserId: 1, status: 1, timestamp: -1 })

// –ü—Ä–æ–≤–µ—Ä–∫–∞
print("Users indexes:")
db.users.getIndexes().forEach(idx => printjson(idx))

print("\nSafetyContacts indexes:")
db.safetyContacts.getIndexes().forEach(idx => printjson(idx))

print("\nSOSAlerts indexes:")
db.sosAlerts.getIndexes().forEach(idx => printjson(idx))
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤:
- ‚úÖ –ü–æ–∏—Å–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ —É—Å–∫–æ—Ä–∏—Ç—Å—è –≤ 10-100 —Ä–∞–∑
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –±—É–¥–µ—Ç –±—ã—Å—Ç—Ä–µ–µ
- ‚úÖ –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –∫–æ–¥—É –±—É–¥–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–º
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ SOS —Å–∏–≥–Ω–∞–ª–æ–≤ —É—Å–∫–æ—Ä–∏—Ç—Å—è

## –í–∞–∂–Ω–æ

- –ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –û–Ω–∏ –∑–∞–Ω–∏–º–∞—é—Ç –Ω–µ–º–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –ë–î, –Ω–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä—è—é—Ç –∑–∞–ø—Ä–æ—Å—ã
- –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å —Å–µ—Ä–≤–µ—Ä –ù–ï –Ω—É–∂–Ω–æ

