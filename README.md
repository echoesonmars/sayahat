## Sayahat

Next.js 14 приложение для AI-гидов и интерактивных карт путешествий по Казахстану.

## Быстрый старт

1. Установите зависимости:

   ```bash
   npm install
   ```

2. Настройте переменные окружения:

   ```bash
   cp env.example .env.local
   ```

   Затем заполните `OPENAI_API_KEY` собственным ключом OpenAI (он используется **только** на сервере через API-роут `/api/chat`).

3. Запустите локальный сервер:

   ```bash
   npm run dev
   ```

   Приложение будет доступно на [http://localhost:3000](http://localhost:3000).

## AI-чат

- UI чата находится на странице `/ai-guide`.
- Сообщения отправляются на серверный обработчик `app/api/chat/route.ts`, который проксирует запросы к OpenAI.
- При наличии координат пользователя сервер забирает данные о ближайших местах из MongoDB (`places`), формирует контекст и добавляет его к системным сообщениям.
- История диалога хранится только в состоянии клиента и передаётся на сервер порциями (до 10 последних сообщений).

## MongoDB

1. Заполни `MONGODB_URI` и `MONGODB_DB` в `.env.local`.
2. Убедись, что в базе есть коллекция `places` с полями `name`, `city`, `lat`, `lng`, `tags`.
3. Проверить подключение можно запросом `GET /api/places?limit=20`.
4. В `app/api/chat/route.ts` данные из коллекции автоматически будут использоваться для построения контекста GPT.

## Полезные команды

```bash
npm run dev    # режим разработки
npm run build  # продакшн-сборка
npm start      # запуск собранного приложения
npm run lint   # проверка ESLint
```
